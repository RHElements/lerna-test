@import "../../pfe-sass/pfe-sass";

$LOCAL: tabs;

$LOCAL-VARIABLES: (
  BackgroundColor:       transparent,
  Color:                 pfe-var(ui-disabled--text),
  link:                  pfe-var(link),
  focus:                 pfe-var(link--focus),
  highlight:             pfe-var(ui-accent),
  BorderWidth--hover:    #{pfe-var(surface--border-width--active)},
  TabTextColor:          #6a6e73,
  Color--hover:          #151515,
  BorderColor--hover:    pfe-var(surface--base),
  tab: (
    FontSize:            pfe-var(font-size),
    PaddingTop:          calc(#{pfe-var(container-padding)} * .666),
    PaddingRight:        calc(#{pfe-var(container-padding)} * 1.5),
    PaddingBottom:       calc(#{pfe-var(container-padding)} * .666),
    PaddingLeft:         calc(#{pfe-var(container-padding)} * 1.5),
  )
);



/// ===========================================================================
/// HORIZONTAL TAB ORIENTATION
/// ===========================================================================

:host {

  position: relative;
  display: block;
  margin: #{pfe-local($cssvar: Margin, $region: tab, $fallback: 0 0 -1px)};

  // Padding
  padding: #{pfe-local(PaddingTop, $region: tab)} #{pfe-local(PaddingRight, $region: tab)} #{pfe-local(PaddingBottom, $region: tab)} #{pfe-local(PaddingLeft, $region: tab)};

  // Border
  border-top:     #{pfe-local($cssvar: BorderTop, $region: tab, $fallback: #{pfe-local($cssvar: BorderWidth, $region: tab, $fallback: #{pfe-var(ui--border-width)})} #{pfe-var(ui--border-style)} #{pfe-local(BorderColor, transparent, $region: tab)} )};
  border-right:   #{pfe-local($cssvar: BorderRight, $region: tab, $fallback: #{pfe-local($cssvar: BorderWidth, $region: tab, $fallback: #{pfe-var(ui--border-width)})} #{pfe-var(ui--border-style)} #{pfe-local(BorderColor, transparent, $region: tab)} )};
  border-bottom:  #{pfe-local(BorderBottom, 0, $region: tab)};
  border-left:    #{pfe-local($cssvar: BorderLeft, $region: tab, $fallback: #{pfe-local($cssvar: BorderWidth, $region: tab, $fallback: #{pfe-var(ui--border-width)})} #{pfe-var(ui--border-style)} #{pfe-local(BorderColor, transparent, $region: tab)} )};

  // Inner style
  background-color: #{pfe-local(BackgroundColor)};
  color: #{pfe-local(TabTextColor)};

  cursor: pointer;
  text-align: #{pfe-local(TextAlign, center, $region: tab)};

  // Exposing this for customization
  text-transform: #{pfe-local($cssvar: TextTransform, $region: tab, $fallback: none)};
  font-family:  #{pfe-var(font-family)};
  font-weight:  #{pfe-var(font-weight--normal)};
  font-size:    #{pfe-local(FontSize, $region: tab)};

  @for $i from 1 through 6 {
    .pfe-tab > * {
      font-size: inherit;
      font-weight: inherit;
      margin: 0;
    }
  }

  @at-root #{&}(:hover) {
    --pfe-tabs--Color: #{pfe-var(text)};
    color: #{pfe-local(Color--hover)};
    @include browser-query(ie11) {
      color: #{pfe-var(text)};
    }
  }

  // Active tab styles
  // TODO: ShadyCSS falls flat on this pseudo element in IE11 `:host(:focus-visible)`, add back when we drop ShadyCSS
  @at-root #{&}(:focus) {
    //--pfe-tabs--Color: #{pfe-var(text)};
    color: #{pfe-local(Color--hover)};
    outline: #{pfe-var(ui--focus-outline-width)} outset #{pfe-local(focus)};
  }

  @at-root #{&}([on="dark"]),
  #{&}([on="saturated"]) {
    --#{$repo}-tabs--focus: #{pfe-var(link--focus--on-dark)};
  }
  // @at-root #{&}([on="saturated"]) {
  //   --#{$repo}-tabs--focus: #{pfe-var(link--focus--on-dark)};
  // }

  // @at-root #{&}([on="saturated"]) {
  //   --#{$repo}-tabs--Color: #{darken($pfe-color--white, 20%)};
  //   --#{$repo}-tabs--focus: #{pfe-var(link--focus--on-saturated)};
  //   --#{$repo}-tabs--highlight: #{pfe-var(text--on-saturated)};
  // }

  @at-root #{&}([aria-selected="true"]) {
    --pfe-tabs--Color: #{$pfe-color--black};
    color: #{pfe-local(Color--hover)};
    --pfe-tabs__tab--BorderColor: transparent;
    --pfe-tabs__tab--BorderBottom: #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} #{pfe-local(highlight)};
    @include browser-query(ie11) {
      color: #{pfe-local(Color--hover)};
      border-bottom: #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} #{pfe-var(ui-accent)};
    }
  }
}

/// ===========================================================================
/// VERTICAL TAB ORIENTATION
/// ===========================================================================

@media screen and (min-width: #{pfe-breakpoint(md)}) {
  :host([vertical]) {
    --#{$repo}-tabs__tab--BorderTop: #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} transparent;
    --#{$repo}-tabs__tab--BorderRight: 0;
    //--#{$repo}-tabs__tab--BorderBottom: #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} transparent;
    --#{$repo}-tab__BorderBottom: 0;
    --#{$repo}-tabs__tab--BorderLeft: #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} transparent;
    --#{$repo}-tabs__tab--Margin: 0 -1px 0 0;
    --#{$repo}-tabs__tab--PadingLeft: calc(#{pfe-var(container-padding)} * .75);
    --#{$repo}-tabs__tab--TextAlign: left;

      @include browser-query(ie11) {
        border: 1px solid transparent;
        border-bottom: 0;
        border-right: 0;
        margin: 0 -1px 0 0;
        padding-left: 12px;
        text-align: left;
      }
  }

  :host([vertical][aria-selected="true"]) {
    --pfe-tabs__tab--BorderTopColor: transparent;
    --pfe-tabs__tab--BorderRight:    #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} #{pfe-local(highlight)};
    --pfe-tabs__tab--BorderBottom:   0;

    @include browser-query(ie11) {
      color:            #{$pfe-color--black};
      border-top-color: transparent;
      border-right:     #{pfe-fetch(surface--border-width--heavy)} #{pfe-var(surface--border-style)} #{pfe-var(ui-accent)};
      border-bottom:    0;
    }
  }
}

:host([pfe-variant="earth"]) {
  @include browser-query(ie11) {
    background-color: #{pfe-fetch(surface--lighter)};
    color:            #{pfe-fetch(text)};
  }
}

/// ===========================================================================
/// WIND TAB VARIANTS / DEFAULT
/// ===========================================================================

@each $theme in $THEMES { // dark, saturated, and light
  :host([aria-selected="true"][on="#{$theme}"]),
  :host([on="#{$theme}"]:hover),
  :host([pfe-variant="wind"][aria-selected="true"][on="#{$theme}"]),
  :host([pfe-variant="wind"][on="#{$theme}"]:hover) {
    @if $theme != "light" {
      --#{$repo}-tabs--Color: #{pfe-var(text--on-#{$theme})};
    }
    @else {
      --#{$repo}-tabs--Color: #{pfe-var(text)};
    }
  }
  :host([pfe-variant="wind"][on="#{$theme}"]:hover) {
    @if $theme != "light" {
      color: #fff;
    }
  }
  :host([pfe-variant="wind"][aria-selected="true"][on="#{$theme}"]) {
    @if $theme != "light" {
      color: $pfelements--gray-light;
    }
  }
}

:host{
  @at-root #{&}([vertical][pfe-variant="wind"]){
    --pfe-tabs__tab--BorderLeft: #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} #{pfe-var(surface--border)};
    @include browser-query(ie11) {
      border-left: #{pfe-fetch(ui--border-width)} #{pfe-var(ui--border-style)} #{pfe-fetch(surface--border)};
    }
  }
  @at-root #{&}[pfe-variant="wind"][aria-selected="false"]:hover){
    --pfe-tabs__tab--BorderBottom: #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} #{pfe-local(BorderColor--hover)};// :host([pfe-variant="wind"][aria-selected="true"]) {
    @include browser-query(ie11) {
      border-bottom:  #{pfe-local(BorderWidth--hover)} #{pfe-fetch(surface--border-style)} #{pfe-local(BorderColor--hover)};
    }
  }
  @at-root #{&}([vertical][pfe-variant="wind"][aria-selected="true"]){
    --pfe-tabs__tab--BorderRight: #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} transparent;
    --pfe-tabs__tab--BorderLeft:  #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} #{pfe-local(highlight)};
    padding-left:                 calc(#{pfe-var(container-padding)} * 1.5 - 2px);
    @include browser-query(ie11) {
      border-right:  0;
      border-left:   #{pfe-local(BorderWidth--hover)} #{pfe-fetch(surface--border-style)} #{pfe-local(highlight)};
      padding-left:  10px;
    }
  }
  @at-root #{&}([vertical][pfe-variant="wind"][aria-selected="false"]){
    --pfe-tabs__tab--BorderRight: #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} transparent;
  }
  @at-root #{&}([vertical][pfe-variant="wind"][aria-selected="false"]:hover){
    --pfe-tabs__tab--BorderRight: #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} transparent;
    --pfe-tabs__tab--BorderBottom: 0;
    --pfe-tabs__tab--BorderLeft: #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} #{pfe-local(BorderColor--hover)};
    padding-left: calc(#{pfe-var(container-padding)} * 1.5 - 2px);
    @include browser-query(ie11) {
      border-right:  0;
      border-bottom: 0;
      padding-left:  10px;
      border-left:   #{pfe-local(BorderWidth--hover)} #{pfe-fetch(surface--border-style)} #{pfe-local(BorderColor--hover)};
    }
  }
}


/// ===========================================================================
/// EARTH TAB VARIANTS
/// ===========================================================================

:host([pfe-variant="earth"][aria-selected="false"]) {
  $variantEarth: (
    BackgroundColor: #f0f0f0,
    tab: (
      BorderLeft:    #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} #{pfe-var(surface--border)},
      BorderBottom:  #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} #{pfe-var(surface--border)},
      BorderTop:     #{pfe-local(BorderWidth--hover)} #{pfe-var(ui--border-style)} transparent,
    )
  );
  @include pfe-print-local($variantEarth);
  @include browser-query(ie11) {
    border-top:    3px solid #{pfe-fetch(surface--lighter)};
    border-bottom: 1px solid #{pfe-fetch(surface--border)};
    border-left:   1px solid #{pfe-fetch(surface--border)};
  }
}

:host([pfe-variant="earth"][aria-selected="false"]:hover){
  --pfe-tabs__tab--BorderTop: #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} #{pfe-local(BorderColor--hover)};
  @include browser-query(ie11) {
    border-top: #{pfe-local(BorderWidth--hover)} #{pfe-fetch(surface--border-style)} #{pfe-local(BorderColor--hover)} !important;
  }
}

:host([pfe-variant="earth"][aria-selected="true"]) {
  --#{$repo}-tabs--BackgroundColor: #{pfe-var(surface--lightest)};
  --#{$repo}-tabs--Color:           #{pfe-var(text)};

  --pfe-tabs__tab--BorderTop:       #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} #{pfe-local(highlight)};
  --pfe-tabs__tab--BorderBottom:    0;
  --pfe-tabs__tab--BorderLeft:      #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} #{pfe-var(surface--border)};

  @include browser-query(ie11) {
    color:            #{pfe-fetch(text)};
    background-color: #fff;
    border-left:      #{pfe-fetch(ui--border-width)} #{pfe-fetch(ui--border-style)} #d2d2d2;
    border-top:       #{pfe-local(BorderWidth--hover)} #{pfe-fetch(ui--border-style)} #{pfe-local(highlight)};
    border-bottom:    0;
  }
}
:host([pfe-variant="earth"][aria-selected="false"]:first-of-type) {
  border-left: #{pfe-var(ui--border-width)} #{pfe-var(surface--border-style)} transparent !important;
}
:host([pfe-variant="earth"][aria-selected="true"]:last-of-type) {
  --#{$repo}-tabs__tab--BorderRight: #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} #{pfe-var(surface--border)};

  @include browser-query(ie11) {
    border-right: 1px solid #{pfe-fetch(surface--border)};
  }
}

/// ===========================================================================
/// EARTH TAB VERTICAL ORIENTATION
/// ===========================================================================

@media screen and (min-width: #{pfe-breakpoint(md)}) {
  :host([vertical][pfe-variant="earth"]) {
    --#{$repo}-tabs__tab--BorderTop: #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} #{pfe-var(surface--border)};

    @include browser-query(ie11) {
      border-top: 1px solid #{pfe-fetch(surface--border)};
    }
  }

  :host([vertical][pfe-variant="earth"]:first-of-type) {
    --#{$repo}-tabs__tab--BorderTop: 0;

    @include browser-query(ie11) {
      border-top: 0;
    }
  }
  :host([vertical][pfe-variant="earth"][aria-selected="false"]:first-of-type) {
    border-top:  #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} transparent !important;
    border-left: #{pfe-local(BorderWidth--hover)} #{pfe-var(ui--border-style)} transparent !important;
    @include browser-query(ie11) {
      border-top: 1px #{pfe-fetch(ui--border-style)} transparent !important;
    }
  }

  :host([vertical][pfe-variant="earth"]:first-of-type[aria-selected="false"]:hover ){
    --pfe-tabs__tab--BorderTop:  #{pfe-var(ui--border-style)} #{pfe-var(ui--border-style)} transparent;
    --pfe-tabs__tab--BorderLeft: #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} #{pfe-local(BorderColor--hover)} !important;
    @include browser-query(ie11) {
      border-top:  1px #{pfe-fetch(ui--border-style)} transparent !important;
      border-left: #{pfe-local(BorderWidth--hover)} #{pfe-fetch(surface--border-style)} #{pfe-local(BorderColor--hover)} !important;
    }
  }
  :host([vertical][pfe-variant="earth"][aria-selected="true"]) {
    --pfe-tabs__tab--BorderTop:   #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} #{pfe-var(surface--border)};
    --pfe-tabs__tab--BorderRight: 0;
    --pfe-tabs__tab--BorderLeft:  #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} #{pfe-local(highlight)};

    @include browser-query(ie11) {
      border-top:   1px solid #{pfe-fetch(surface--border)};
      border-right: 0;
      border-left:  3px solid #{pfe-local(highlight)};
    }
  }

  :host([vertical][pfe-variant="earth"][aria-selected="false"]) {
    --pfe-tabs__tab--BorderRight:  #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} #{pfe-var(surface--border)};
    --pfe-tabs__tab--BorderBottom: 0;
    --pfe-tabs__tab--BorderLeft:   #{pfe-local(BorderWidth--hover)} #{pfe-var(ui--border-style)} transparent;

    @include browser-query(ie11) {
      border-right:  1px solid #{pfe-fetch(surface--border)};
      border-bottom: 0;
      border-left:   3px solid #{pfe-fetch(surface--lighter)};
    }
  }

  :host([vertical][pfe-variant="earth"][aria-selected="false"]:hover){
    --pfe-tabs__tab--BorderLeft: #{pfe-local(BorderWidth--hover)} #{pfe-var(surface--border-style)} #{pfe-local(BorderColor--hover)};
    --pfe-tabs__tab--BorderTop:  #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} #{pfe-var(surface--border)};
    @include browser-query(ie11) {
      border-left: #{pfe-local(BorderWidth--hover)} #{pfe-fetch(surface--border-style)} #{pfe-local(BorderColor--hover)} !important;
      border-top:  #{pfe-fetch(ui--border-width)} #{pfe-fetch(ui--border-style)} #{pfe-fetch(surface--border)} !important;
    }
  }

  :host([vertical][pfe-variant="earth"][aria-selected="true"]:last-of-type) {
    --#{$repo}-tabs__tab--BorderBottom: #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} #{pfe-var(surface--border)};

    @include browser-query(ie11) {
      border-bottom: 1px solid #{pfe-fetch(surface--border)};
    }
  }
}

/// ===========================================================================
/// EARTH TAB VARIANTS ON DARK
/// ===========================================================================

:host{
    @at-root #{&}([pfe-variant="earth"][aria-selected="false"][on="dark"]) {
      --#{$repo}-tabs--BackgroundColor: #3c3f42; //replace with var when Kendall is done with her updates. She might be adding this color
      color: #{pfe-var(ui-disabled)};
    }
    @at-root #{&}([pfe-variant="earth"][aria-selected="false"][on="dark"]:first-of-type) {
      border-left: #{pfe-var(ui--border-width)} #{pfe-var(surface--border-style)} transparent !important;
    }
      @at-root #{&}([pfe-variant="earth"][aria-selected="true"][on="dark"]) {
        color: #{pfe-var(surface--lightest)};
        --#{$repo}-tabs--BackgroundColor: #{pfe-local(Color--hover)};
    }
      @at-root #{&}([pfe-variant="earth"][aria-selected="false"][on="dark"]:hover) {
        color: #{pfe-var(surface--lightest)} !important;
    }
}
