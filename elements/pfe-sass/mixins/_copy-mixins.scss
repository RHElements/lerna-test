////
/// Tools for typography
/// @group Typography
/// @author starryeyez024
////

/// Typography mixin for component use. This mixin allows you to request all typography styles with  optional hooks for local and light DOM variable overrides. Please note that the default type is "title", becaus most text won't need typographical styles, it will inherit from the body element. 
/// @param {String} $size  [2xl] - Enter a t-shirt size of your choosing: 6xl, 5xl, 4xl, 3xl, 2xl, xl, lg, md, sm, xs
/// @param {String} $type [title]- Level of typography: either "text", "title", or "mega-title"
/// @param {Boolean} $use-local [true] - This will print a local variable at the beginning of the variable stacks 
/// @param {String} $region - For use with local variables, you may include a nested region within the component variable map
/// @param {Boolean} $light-dom-heading: [false] - print the --pf-c--FontSize variable with a value of the font-size variable stack. For more information about --pf-c--FontSize, see the HTML HEADINGS section in pfe-base.scss
/// @see $pf-type-sizing
/// @example scss - basic heading
///   .pfe-component--heading {
///     @include pfe-typography("5xl");
///   }
/// @example css - Rendered result
///   .pfe-component--heading {
///     font-family: "Red Hat Display", "RedHatDisplay", "Overpass", Overpass, Arial, sans-serif;
///     font-family: var(--pfe-theme--font-family--heading, "Red Hat Display", "RedHatDisplay", "Overpass", Overpass, Arial, sans-serif);
///     font-size: 2.5rem;
///     font-size: var(--pfe-cta--FontSize, var(--pf-global--FontSize--5xl, 2.5rem));
///     line-height: 1.3;
///     line-height: var(--pfe-cta--LineHeight, var(--pfe-theme--line-height--heading, 1.3));
///     font-weight: 500;
///     font-weight: var(--pfe-cta--FontWeight, var(--pfe-theme--font-weight--normal, 500));
///   }
/// @example scss - 
///   .pfe-component--custom-heading-6xl--without-local-var--with-region {
///     @include pfe-typography($size: "6xl", $type: "mega-title", $use-local: false, $region: "heading");
///   }
/// @example css - Rendered result
///   .pfe-component--custom-heading-6xl--without-local-var--with-region {
///     font-family: "Red Hat Display", "RedHatDisplay", "Overpass", Overpass, Arial, sans-serif;
///     font-family: var(--pfe-theme--font-family--heading, "Red Hat Display", "RedHatDisplay", "Overpass", Overpass, Arial, sans-serif);
///     font-size: 3rem;
///     font-size: var(--pfe-cta__heading--FontSize, var(--pf-global--FontSize--6xl, 3rem));
///     line-height: 1.2;
///     line-height: var(--pfe-cta__heading--LineHeight, var(--pfe-theme--line-height--heading-mega, 1.2));
///     font-weight: 400;
///     font-weight: var(--pfe-cta__heading--FontWeight, var(--pfe-theme--font-weight--light, 400));
///   }
/// @example scss 
///   .pfe-component--custom-heading-6xl--with-light-dom-hook {
///     @include pfe-typography($size: "6xl", $light-dom-heading: true);
///   }
/// @example css  - Rendered result
///   .pfe-component--custom-heading-6xl--with-light-dom-hook {
///     font-family: "Red Hat Display", "RedHatDisplay", "Overpass", Overpass, Arial, sans-serif;
///     font-family: var(--pfe-theme--font-family--heading, "Red Hat Display", "RedHatDisplay", "Overpass", Overpass, Arial, sans-serif);
///     --pf-c--FontSize: var(--pfe-cta--FontSize, var(--pf-global--FontSize--md, 1rem));
///     font-size: 3rem;
///     font-size: var(--pfe-cta--FontSize, var(--pf-global--FontSize--6xl, 3rem));
///     line-height: 1.3;
///     line-height: var(--pfe-cta--LineHeight, var(--pfe-theme--line-height--heading, 1.3));
///     font-weight: 500;
///     font-weight: var(--pfe-cta--FontWeight, var(--pfe-theme--font-weight--normal, 500));
///   }
///

@function get-value($local, $prop, $set, $region) {
    @if $local {
        @return pfe-local($prop, map-get($set, $prop), $region);
    } @else {
        @return map-get($set, $prop);
    }
}

@mixin pfe-typography (
    $type: "title",
    $size: "xl",
    $use-local: true,
    $region: null,
    $light-dom-cascade: false,
    $content-spacer: true,
    $props: (font-size, font-family, font-weight, line-height),
    $exclude-base: false
){
    @warn $type;
    // Check that this type exists in the typography set
    @if index($pf-typography-sets, $type) == null {
        // Throw an error if not found
        @error "#{$type} not found in the supported typography sets from $pf-typography-sets."
    } @else {
        $all: map-get($pf-typography-sets, $type);
        // Check that this size exists in the captured set
        @if index($all, $sizing) == null {
            // Throw an error if not found
            @error "#{$sizing} not found in the supported #{$type} sizes."
        } @else {
            $set: map-get($all, $sizing);

            // Remove the base properties from the list if true
            @if $exclude-base == true {
                @each $prop in (font-family, font-weight, line-height) {
                    $props: remove($props, $prop);
                }
            }

            // Add the light DOM custom property if true and font-size is in the props list
            @if $light-dom-cascade and index($props, font-size) != null {
                $value: get-value($use-local, FontSize, $set, $region);
                // Result to be printed
                --pf-c--FontSize: #{$value};
            }

            @each $prop in $props {
                $bem: str-to-bem($prop);
                $value: get-value($use-local, $bem, $set, $region);

                // Add the light DOM custom property if true and font-size is in the props list
                @if $light-dom-cascade and $prop == "font-size" {
                    --pf-c--#{$bem}: #{$value};
                }
                #{$prop}: #{$value};
            }

            // If the content-spacer boolean is true, clear the 
            @if $content-spacer {
                $value: get-value($use-local, content-spacer, $set, $region);
                &:not(:last-child):not(:empty) {
                    margin-bottom: #{$value};
                }
            }
        }
    }
}

@mixin pfe-accessibility-focus($color: $link-color) {
  outline-offset: 1px;
  outline-style: dotted;
  outline-width: 1px;
  text-decoration: none !important;

  @if type-of($color) ==color {
    outline-color: $color;
  }
}

@mixin pfe-underline($color: default-link-hover-line, $opacity: 1) {
  text-decoration: underline;
  text-decoration-skip: ink;
}


/// HTML TYPOGRAPHY

/// BASE LEVEL TYPOGRAPHY
/// for the body tag
%pfe-text--base {
    font-family: pfe-var(font-family);
    font-weight: pfe-var(font-weight--light);
    line-height: pfe-var(line-height);
}

/// TEXT MODIFIER CLASSES
@mixin pfe-text ( $sizing: "md", $base: true) {
  // these styles are ordinarily inherited from the body tag, but some projects may need extra specificity
  @if $base == true {
      @extend %pfe-text-base;
  }
  &:not(:last-child):not(:empty) {
      margin-bottom: pfe-var(content-spacer--body--md); //16px
  }

  // Get the font-size from the $pf-typography-sets map
  font-size: map-deep-get($pf-typography-sets, text, $sizing);
//   @if $sizing == "md" {
//     font-size:   pfe-var(content--FontSize);
//   }
//   @else if $sizing == "sm" {
//     font-size:   pfe-var(content--small--FontSize);
//   }
//   @else {
//     font-size:   pfe-var(content--#{$sizing}--FontSize);
//   }
}


/// The variable stack includes a hook just for headings when they appear in the 
/// light DOM within components: --pf-c--FontSize
///
/// Components can't control the font size of block level elements like HTML headings 
/// when they are in the light DOM.  A component _could_ redefine the variables for 
/// standard headings by using the variable hooks such as: `--pf-c--content--h4--FontSize` 
/// but it can't know if the light DOM might contain an H1, H2, H3, etc. it shouldn't
/// redefine the variables for all possible headings. Instead, there is one dedicated
/// variable for this purpose. 
@mixin pfe-content-heading ( $sizing: "h1" ){
    font-family: pfe-var(font-family--heading);
    font-size:   var( --pf-c--FontSize, pfe-var(content--#{$sizing}--FontSize));
    line-height: pfe-var(line-height--heading);
    font-weight: pfe-var(font-weight--normal);
    &:not(:last-child):not(:empty) {
        margin-bottom: pfe-var(content-spacer--heading--sm); //16px
    }
}

@mixin pfe-content--text--spacing-block ( $sizing: "md" ) {
    &:not(:last-child):not(:empty) {
        margin-bottom: pfe-var(content-spacer--body--#{$sizing}); //16px
    }
} 