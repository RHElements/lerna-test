@import "../../pfe-sass/pfe-sass";

$LOCAL: navigation-item;

:host {
  --pfe-navigation-item--Color: #{pfe-color(text--on-dark)};
  --pfe-navigation-item--BackgroundColor: #{pfe-color(surface--darkest)};
  --pfe-navigation-item--BorderTopColor: transparent;

  --pfe-navigation-item__icon--Background: none;

  height: 100%;
  display: flex;
  flex-flow: column nowrap;
  align-items: center;
  justify-content: center;
}

:host([pfe-icon]) {
  display: flex;
}

@each $icon in (bento, user, globe, search, menu) {
  :host([pfe-icon="#{$icon}"]) {
    --pfe-navigation-item__icon--Background: #{map-get($icons, #{$icon}--on-dark)} no-repeat;
  }
  :host([pfe-icon="#{$icon}"].expanded) .pfe-navigation-item__trigger {
    --pfe-navigation-item__icon--Background: #{map-get($icons, #{$icon})} no-repeat;
  }
}

:host([hidden]),
::slotted([slot="tray"][hidden]) {
	display: none;
}

::slotted([slot="trigger"]) {
  font-family: #{pfe-var(font-family)};
  text-align: center;
  font-size: 14px !important;
  font-weight: 100;
  margin: 0;
  cursor: pointer;
  text-decoration: none;
  white-space: nowrap;
}

:host([pfe-icon]) ::slotted([slot="trigger"]) {
  font-size: 12px !important;
}

::slotted([slot="tray"]) {
  padding: 24px;
}

.pfe-navigation-item {
  &__icon {
    display: flex;
    background: var(--pfe-navigation-item__icon--Background);

    :host(:not([pfe-icon])) [aria-expanded="false"] & {
      visibility: hidden;
    }

    :host(:not([pfe-icon])) & {
      @include pfe-arrow(down, gray, $width: 6px, $height: 6px);
      position: absolute;
      bottom: 13px;
    }

    :host([pfe-icon]) & {
      margin-bottom: calc(#{pfe-var(container-spacer)} / 2);
      width: 1.3em;
      height: 1.3em;
    }
  }
  &__trigger {
    --pfe-theme--link--text-decoration: none;
    --pfe-theme--link--text-decoration--hover: none;
    --pfe-theme--link--text-decoration--focus: none;

    --pfe-broadcasted--color--ui-link:          #{pfe-local(Color)};
    --pfe-broadcasted--color--ui-link--hover:   #{pfe-local(Color)};
    --pfe-broadcasted--color--ui-link--visited: #{pfe-local(Color)};
    --pfe-broadcasted--color--ui-link--focus:   #{pfe-local(Color)};

    transition: all #{pfe-var(animation-timing)};

    position: relative;

    display: flex;
    flex-flow: column nowrap;
    align-items: center;
    justify-content: center;
    flex-grow: 1;

    background-color: #{pfe-local(BackgroundColor)};
    padding: 20px 16px !important;

    border-top: 4px solid #{pfe-local(BorderTopColor)};
    color: #{pfe-local(Color)};

    &:hover,
    :host([aria-current="location"]) & {
      --pfe-navigation-item--BorderTopColor:  #{pfe-color(surface--accent)};
    }

    &[aria-expanded="true"],
    .expanded & {
      --pfe-navigation-item--Color: #{pfe-color(text)};
      --pfe-navigation-item--BackgroundColor: #{pfe-color(surface--lightest)};
      --pfe-navigation-item--BorderTopColor:  #{pfe-color(surface--accent)};
    }

    &:focus:not(:focus-visible) {
      outline: none;  // removes outline for mouse users, preserves it for keyboard users
    }
  }
  &__tray {
    width: 100%;
    margin: 0 auto;
  
    transition: all #{pfe-var(animation-timing)};
    background-color: #{pfe-color(surface--lightest)};
  
    display: block;
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1;
    color: #{pfe-color(surface--lightest--text)};
  }
}
