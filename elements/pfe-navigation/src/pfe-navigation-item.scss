@import "../../pfe-sass/pfe-sass";

$LOCAL: navigation-item;

/// ===========================================================================
/// Component Specific SASS Vars
/// ===========================================================================
$pfe-nav-size: 4em;

/// ===========================================================================
/// DEFAULT navigation-item
/// ===========================================================================
:host {
	// Update the navigation padding in this context
	--pfe-navigation-item--Padding--vertical:   #{pfe-var(container-spacer)};
	--pfe-navigation-item--Padding--horizontal: #{pfe-var(container-spacer)};

	--pfe-navigation-item__tray--Width__aside--sm: 240px;
	--pfe-navigation-item__tray--Width__aside--lg: 300px;

	--pfe-navigation-item--Color: 					#{pfe-local(main)};
	--pfe-navigation-item--BackgroundColor: #{pfe-local(aux)};
	--pfe-navigation-item--BorderTopColor:	transparent;

	// Fill the navigation container
	height: 100%;
	font-family: #{pfe-var(font-family)};

	/// ===========================================================================
	/// MOBILE
	/// ===========================================================================
	// @media (max-width: #{pfe-breakpoint(lg-max)} ) {
		// display: inline-block;
	// }

	/// ===========================================================================
	/// DESKTOP
	/// ===========================================================================
	// @media (min-width: #{pfe-breakpoint(lg)}) {
		--pfe-navigation-item--main:        #{pfe-color(text)};              // text
		--pfe-navigation-item--main--hover: #{pfe-color(text--on-dark)};     // text hover

		--pfe-navigation-item--aux:         transparent;                     // bg
		--pfe-navigation-item--aux--hover:  #{pfe-color(surface--darkest)};  // bg hover

		font-weight: bold;
		font-weight: 300;
		min-height:  #{$pfe-nav-size};

		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		padding: 0 3px;
	// }
}

/// ===========================================================================
/// ON DARK
/// ===========================================================================
:host([on="dark"]) {
	// @media (min-width: #{pfe-breakpoint(lg)}) {
		--pfe-navigation-item--main:        #{pfe-color(text--on-dark)};      // text
		--pfe-navigation-item--main--hover: #{pfe-color(text)};               // text hover

		--pfe-navigation-item--aux:         transparent;                      // bg
		--pfe-navigation-item--aux--hover:  #{pfe-color(surface--lightest)};  // bg hover
	// }
}

:host([hidden]) {
	display: none;
}

:host([hidden][pfe-top-link]) {
	@media (max-width: #{pfe-breakpoint(md, $max: true)}) {
		display: flex !important;
	}
}

// Clear the styles for links in the trigger slot
::slotted(a:not([slot="tray"])) {
	color: inherit;
	text-decoration: none;
	// Fill the link container
	margin-top: -2px;
	width: 100%;
	display: flex;
	align-items: center;
}

// ::slotted([slot="trigger"]) {
// 	@media (max-width: #{pfe-breakpoint(lg, $max: true)}) {
// 		@include pfe-trigger-button;
// 		@include pfe-trigger-expanded;
// 	}
// }

::slotted([slot="tray"]) {
	display: contents;
}

.pfe-navigation-item {
	&__tray {
		// @media (max-width: #{pfe-breakpoint(lg, $max: true)}) {
		// 	@include pfe-accordion-panel-expanded;
		// }
		// @media (min-width: #{pfe-breakpoint(lg)}) {
			display: block;
			background-color: #{pfe-color(surface--lighter)};
			position: absolute;
			// top: var(--pfe-navigation--Height, 70px); // @TODO Need to do this with JS
			top: 80px;
			left: 0;
			width: 100%;
			z-index: 1;
			transition: all #{pfe-var(animation-timing)};
		// }

		&[hidden] {
			display: none;
		}
	}
	&__container {
		// @media (max-width: #{pfe-breakpoint(lg, $max: true)}) {
		// 	@include pfe-accordion-panel-container;
		// }
		// @media (min-width: #{pfe-breakpoint(lg)}) {
			display: 		flex;
			flex-flow:  row wrap;
			margin:    	10px auto;
			width: 			var(--pfe-navigation--Width);
		// }
	}
	&__trigger {
		transition: all #{pfe-var(animation-timing)};
		cursor: 			pointer;
		text-decoration: 	none;

		border-top:       #{pfe-local(BorderTopColor)} solid 2px;
		color:            #{pfe-local(Color)}; //text
		background-color: #{pfe-local(BackgroundColor)};  //bg
		line-height: 			#{$pfe-nav-size};

		@media (max-width: #{pfe-breakpoint(lg, $max: true)}) {
			// --pfe-navigation-item--Color:			#{pfe-local(main--hover)};
			// --pfe-navigation-item--BackgroundColor: #{pfe-local(aux--hover)};
			// --pfe-navigation-item--BorderTopColor:  #{pfe-color(surface--accent)};
			
			// If it's not a top-level link, hide it in mobile from the nav
			&:not([pfe-top-link]) {
				display: none;
			}
			// If it doesn't have an icon, give it menu flyout styles
			&:not([pfe-icon]) {
				@include pfe-trigger-button;
				@include pfe-trigger-expanded;
	
				&[aria-expanded="false"]::after {
					@include pfe-chevron-expanded-false;
				}
				&[aria-expanded="true"]::after {
					@include pfe-chevron-expanded-true;
				}
			}
		}

		// Desktop styles
		@media (min-width: #{pfe-breakpoint(lg)}) {
			flex: 1;
			display:			flex;
			flex-direction: 	column;
			align-items: 		center;
			justify-content: 	center;
			padding: 0 3px;

			// Fill the navigation container
			height: 			100%;
		}

	  &:hover {
			--pfe-navigation-item--Color:			#{pfe-local(main--hover)};
			--pfe-navigation-item--BackgroundColor: #{pfe-local(aux--hover)};
			--pfe-navigation-item--BorderTopColor:  #{pfe-color(surface--accent)};
	  }
	  &:active {
			--pfe-navigation-item--Color:			#{pfe-local(main--hover)};
			--pfe-navigation-item--BackgroundColor: #{pfe-local(aux--hover)};
			--pfe-navigation-item--BorderTopColor:  #{pfe-color(surface--accent)};
	  }
	  &:focus {
			--pfe-navigation-item--Color: 			#{pfe-local(main--hover)};
			--pfe-navigation-item--BackgroundColor: #{pfe-local(aux--hover)};
			--pfe-navigation-item--BorderTopColor:  #{pfe-color(surface--accent)};
	  	&:not(:focus-visible) {
	  		outline: none; // removes outline for mouse users, preserves it for keyboard users
	  	}
	  }
	}

	&__icon {
		// @media (min-width: #{pfe-breakpoint(lg)}) {
			padding: 0 0 10px 0;
			display: flex;
			width: 	20px;

			[pfe-icon="bento"] & #Icon {
				-webkit-text-fill-color: 	 #{pfe-local(Color)};
				fill: 	#{pfe-local(Color)};
			}
			[pfe-icon="menu"] & #Icon {
				-webkit-text-stroke-color: #{pfe-local(Color)};
				-webkit-text-fill-color: 	 #{pfe-local(Color)};
				stroke: #{pfe-local(Color)};
				fill: 	#{pfe-local(Color)};
			}
			[pfe-icon="user"] & #Icon,
			[pfe-icon="globe"] & #Icon,
			[pfe-icon="search"] & #Icon {
				-webkit-text-stroke-color: #{pfe-local(Color)};
				stroke: #{pfe-local(Color)};
			}
		// }
	}

	&__text,
	&__link {
		margin: 0;
		color:  inherit;
		line-height: 1.2;

		@media (max-width: #{pfe-breakpoint(lg, $max: true)}) {
			[pfe-top-link] & {
				font-size: 0.9em;
				padding: 0 #{pfe-local(Padding--horizontal)};
			}
		}

		@media (min-width: #{pfe-breakpoint(lg)}) {
			font-size: 0.9em;
			padding: 0 #{pfe-local(Padding--horizontal)};
		}

		//shrink the text size of nav items with icons
		[pfe-icon] & {
			font-size: 0.8em;
		}

	}
}
