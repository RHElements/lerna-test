@import "../../pfe-sass/pfe-sass";

@mixin pfe-cta-focus($border-color) {
  &::before {
    content: "";
    border: 1px solid $border-color;
    outline: none;
    left: 2px;
    top: 2px;
    right: 2px;
    bottom: 2px;
    display: block;
    box-sizing: border-box;
    position: absolute;
    border-radius: 2px;
  }
}

$LOCAL: cta;
$pfe-cta__arrow-size:                        0.313em;

:host {
  // Property variables
  --pfe-cta--Padding:      0;
  --pfe-cta--BorderRadius: 0;

  --pfe-cta__arrow--Display:  inline-block;

  // Color settings
  --pfe-cta--main: #{pfe-color(ui-link)};
  --pfe-cta--aux:  transparent;

  @each $state in (hover, focus) {
    --pfe-cta--main--#{$state}: #{pfe-color(ui-link--#{$state})};
    --pfe-cta--aux--#{$state}:  transparent;
  }

  --pfe-cta--BorderColor:     transparent;
  --pfe-cta--BackgroundColor: transparent;
  --pfe-cta--Color:           #{pfe-local(main)};

  // Update the broadcasted variables, map to main color
  --pfe-broadcasted--color--ui-link: #{pfe-local(Color)};

  display: inline-block;
  font-family: #{pfe-var(font-family)};
  font-size:   #{pfe-var(font-size)};
  font-weight: #{pfe-var(font-weight--bold)};
  line-height: #{pfe-var(line-height)};
}

// Style the slotted link element
::slotted(a) {
  position: relative;
  transition: all #{pfe-var(animation-timing)};

  line-height: inherit;
  text-decoration: none;
  vertical-align:  middle;

  color:            #{pfe-local(Color)};
  background-color: #{pfe-local(BackgroundColor)};

  padding:       #{pfe-local(Padding)};
  border-radius: #{pfe-local(BorderRadius)};
  border:        #{pfe-var(ui--border-width)} #{pfe-var(ui--border-style)} #{pfe-local(BorderColor)};

  // @include get-web-icon(web-icon-caret-left) {
  //   color: green;
  // }

  &::after {
    margin-left: calc(#{pfe-var(content-spacer)} * 0.25); // 1/4 of the base `content-spacer`

    // This overrides a display style from the pfe-arrow mixin
    // display:     #{pfe-local($cssvar: Display, $region: arrow)};
    // content: "\f101";
  }
}

// Loop through states and apply update to color
@each $state in (hover, focus) {
  ::slotted(a:#{$state}) {
    --pfe-cta--Color: #{pfe-local(main--#{$state})};
    --pfe-broadcasted--color--ui-link--#{$state}: #{pfe-local(main--#{$state})};
  }
}

/// ===========================================================================
/// DEFAULT CTAs
/// ===========================================================================

:host(:not([priority])) {

  ::slotted(a) {
    display: inline-block;
    --pfe-cta--Padding: .6rem 0;
  }
  ::slotted(a:focus) {
    outline: none;
  }

  .pfe-cta--arrow {
    position: relative;
    top: .1rem; 
    width: 13px;
    height: 13px;
    fill: #{pfe-local(Color)};
    padding: 0 0 0 .375rem;
    transition: .3s ease all;
  }
}

:host([color=complement]:not([priority])) {
  --pfe-cta--main--focus: #{pfe-local(main--focus)};
}

:host(:not([priority]):hover) {
  .pfe-cta--arrow {
    fill: #{pfe-local(main--hover)};
    padding: 1rem 0 1rem .5rem;
    padding: 0 0 0 .5rem;
  }
}

:host(:not([priority]):focus-within) {
    background-color: rgba(0, 102, 204, .1);
    .pfe-cta--arrow {
      fill: #{pfe-local(main--focus)};
    }
}

:host([on="dark"]:not([priority])) {
  ::slotted(a) {
    color: #{pfe-color(ui-link--on-dark)};
  }
  .pfe-cta--arrow {
    fill: #{pfe-color(ui-link--on-dark)};
  }
}

/// ===========================================================================
/// Styles for "Button" CTAs
/// ===========================================================================
:host([priority="primary"],[priority="secondary"]),
:host([pfe-priority="primary"],[pfe-priority="secondary"]) {
  // Button padding and border radius settings
  --pfe-cta--Padding:      #{pfe-var(container-padding)} calc(#{pfe-var(container-padding)} * 2);
  --pfe-cta--BorderRadius: #{pfe-var(ui--border-radius)};
  // Arrow styles
  --pfe-cta__arrow--Display:  none;

  // Loop through states and apply update to color
  @each $state in (hover, focus) {
    ::slotted(a:#{$state}) {
      --pfe-cta--BorderColor:     #{pfe-local(main--#{$state})};
      --pfe-cta--BackgroundColor: #{pfe-local(main--#{$state})};
      --pfe-cta--Color:           #{pfe-local(aux--#{$state})};
      --pfe-broadcasted--color--ui-link--#{$state}: #{pfe-local(aux--#{$state})};
    }
  }
}

/// ===========================================================================
/// PRIMARY CTAs
/// ===========================================================================
:host([priority="primary"]),
:host([pfe-priority="primary"]) {
  --pfe-cta--main:          #{pfe-color(ui-accent)};
  --pfe-cta--aux:           #{pfe-color(ui-accent--text)};

  @each $state in (hover, focus) {
    --pfe-cta--main--#{$state}:  #{pfe-color(ui-accent--#{$state})};
    --pfe-cta--aux--#{$state}:   #{pfe-color(ui-accent--text--#{$state})};
  }

  --pfe-cta--BorderColor:     #{pfe-local(main)};
  --pfe-cta--BackgroundColor: #{pfe-local(main)};
  --pfe-cta--Color:           #{pfe-local(aux)};

  ::slotted(a:focus) {
    @include pfe-cta-focus(#{pfe-local(aux--focus)});
  }
}


// @TODO Set secondary alt styles when we have clarification about how they 
// should be used.

// :host([alt][priority="primary"]),
// :host([alt][pfe-priority="primary"]) {
//   --pfe-cta--main:          #{pfe-color(surface--lightest)};
//   --pfe-cta--main--focus:   #{pfe-color(surface--border--lightest)};
//   --pfe-cta--aux:           #{pfe-color(surface--lightest--text)};
//   --pfe-cta--aux--focus:    #{pfe-color(surface--lightest--text)};

//   --pfe-cta--BorderColor:     #{pfe-local(main)};
//   --pfe-cta--BackgroundColor: #{pfe-local(main)};
//   --pfe-cta--Color:           #{pfe-local(aux)};

//   ::slotted(a:focus) {
//     @include pfe-cta-focus(#{pfe-local(aux--focus)});
//     --pfe-cta--main--focus: white;
//   }
// }

/// ===========================================================================
/// SECONDARY CTAs
/// ===========================================================================
:host([priority="secondary"]),
:host([pfe-priority="secondary"]) {
  --pfe-cta--main:          #{pfe-color(ui-complement)};
  --pfe-cta--aux:           transparent;

  @each $state in (hover, focus) {
    --pfe-cta--main--#{$state}:  #{pfe-color(ui-complement--#{$state})};
    --pfe-cta--aux--#{$state}:   #{pfe-color(ui-complement--text--#{$state})};
  }

  --pfe-cta--BorderColor:     #{pfe-local(main)};
  --pfe-cta--BackgroundColor: #{pfe-local(aux)};
  --pfe-cta--Color:           #{pfe-local(main)};

  ::slotted(a:focus) {
    --pfe-cta--BorderColor:     #{pfe-local(aux--focus)};
    @include pfe-cta-focus(#{pfe-local(aux--focus)});
  }
}

// @TODO Set secondary alt styles when we have clarification about how they 
// should be used.

// :host([alt][priority="secondary"]),
// :host([alt][pfe-priority="secondary"]) {
//   --pfe-cta--main:          #{pfe-color(ui-link)};
//   --pfe-cta-main--focus:    #{pfe-color(ui-link--focus)};
//   --pfe-cta--aux:           transparent;

//   --pfe-cta--BorderColor:     #{pfe-local(main)};
//   --pfe-cta--BackgroundColor: #{pfe-local(aux)};
//   --pfe-cta--Color:           #{pfe-local(main)};

//   ::slotted(a:focus) {
//     --pfe-cta--BorderColor:     #{pfe-local(aux--focus)};
//     @include pfe-cta-focus(#{pfe-local(aux--focus)});
//   }
// }


/// ===========================================================================
/// ON DARK
/// ===========================================================================
// :host([on="dark"]) {
//   --pfe-cta--main:        #{pfe-color(text--on-dark)};

//   @each $state in (hover, focus) {
//     --pfe-cta--main--#{$state}: #{pfe-color(ui-link--on-dark--#{$state})};
//   }
// }


// Secondary variation
:host([on="dark"][priority="secondary"]),
:host([on="dark"][pfe-priority="secondary"]) {
  --pfe-cta--main:        #{pfe-color(ui-base--text)};
  --pfe-cta--aux--hover:  #{pfe-color(ui-complement--hover)};

  @each $state in (hover, focus) {
    --pfe-cta--main--#{$state}: #{pfe-color(surface--lightest)};
  }
}

/// ===========================================================================
/// COLOR OVERRIDES
/// ===========================================================================
@each $color in (base, complement, accent) {
  :host([color="#{$color}"]),
  :host([color="#{$color}"][on="dark"]),
  :host([pfe-color="#{$color}"]),
  :host([pfe-color="#{$color}"][on="dark"]) {
    --pfe-cta--main:        #{pfe-color(ui-#{$color})};
    --pfe-cta--aux:         #{pfe-color(ui-#{$color}--text)};
  
    @each $state in (hover, focus) {
      --pfe-cta--main--#{$state}: #{pfe-color(ui-#{$color}--#{$state})};
      --pfe-cta--aux--#{$state}:  #{pfe-color(ui-#{$color}--text--#{$state})};
    }
  }
}

/// ===========================================================================
/// COLOR OVERRIDE: SECONDARY AUX
/// ===========================================================================
:host([color="base"][priority="secondary"]),
:host([color="base"][priority="secondary"][on="dark"]),
:host([color="complement"][priority="secondary"]),
:host([color="complement"][priority="secondary"][on="dark"]),
:host([color="accent"][priority="secondary"]),
:host([color="accent"][priority="secondary"][on="dark"])
:host([pfe-color="base"][pfe-priority="secondary"]),
:host([pfe-color="base"][pfe-priority="secondary"][on="dark"]),
:host([pfe-color="complement"][pfe-priority="secondary"]),
:host([pfe-color="complement"][pfe-priority="secondary"][on="dark"]),
:host([pfe-color="accent"][pfe-priority="secondary"]),
:host([pfe-color="accent"][pfe-priority="secondary"][on="dark"]) {
  --pfe-cta--aux: transparent;
}
